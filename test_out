machines:  [0, 1, 2]
servers:  [0, 1]
clis:  [2]
nova_servers:  192.168.98.74:10645,192.168.98.70:10645
nova_all_servers:  192.168.98.74:10645
server count:  2
ltc count:  1
stoc count:  1
running experiment:  nova-zf-0.99-nm-256-lr-1-cfg-false-d-uniform-w-workloadw-ltc-1-stoc-1-l0-10240-np-64-nr-1
Result Dir:  /home/yuhang/NovaLSM/nova-experiment-2023-10-16-12-21-20/nova-zf-0.99-nm-256-lr-1-cfg-false-d-uniform-w-workloadw-ltc-1-stoc-1-l0-10240-np-64-nr-1
nova server ip+port:  192.168.98.74:10645,192.168.98.70:10645
ltc config:  /home/yuhang/NovaLSM/config/nova-tutorial-config
db path:  /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024
cc servers:  192.168.98.74:10645
cleaning results
removing resluts at machine  0
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.74
exec on node 0: sudo rm -rf /tmp/results && mkdir -p /tmp/results && chmod -R 777 /tmp/results
exec on node 0: sudo sh -c 'echo 3 >/proc/sys/vm/drop_caches'
removing resluts at machine  1
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.70
exec on node 1: sudo rm -rf /tmp/results && mkdir -p /tmp/results && chmod -R 777 /tmp/results
exec on node 1: sudo sh -c 'echo 3 >/proc/sys/vm/drop_caches'
removing resluts at machine  2
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.53
exec on node 2: sudo rm -rf /tmp/results && mkdir -p /tmp/results && chmod -R 777 /tmp/results
exec on node 2: sudo sh -c 'echo 3 >/proc/sys/vm/drop_caches'
restoring images
restore database image 0
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.74
exec on node 0: rm -rf /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024/ && cp -r /home/yuhang/NovaLSM/db_files/snapshot-1-2-1-uniform-64-16-0.99-1/nova-db-10000000-1024/ /home/yuhang/NovaLSM/db_files/ > /dev/null 2> /dev/null < /dev/null &
restore database image 1
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.70
exec on node 1: rm -rf /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024/ && cp -r /home/yuhang/NovaLSM/db_files/snapshot-1-2-1-uniform-64-16-0.99-1/nova-db-10000000-1024/ /home/yuhang/NovaLSM/db_files/ > /dev/null 2> /dev/null < /dev/null &
syning restoring process
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.74
exec on node 0: ps -ef | grep -v grep | grep -v ssh | grep -v bash | grep -c "cp -r"
wait for it done
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.70
exec on node 1: ps -ef | grep -v grep | grep -v ssh | grep -v bash | grep -c "cp -r"
wait for it done
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.53
exec on node 2: ps -ef | grep -v grep | grep -v ssh | grep -v bash | grep -c "cp -r"
wait for it done
Preparing sar
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.74
exec on node 0: sudo killall leveldb_main nova_shared_main nova_multi_thread_compaction nova_server_main java collectl sar
exec on node 0: sudo collectl -scx -i 1 -P > /tmp/results/0-coll.txt 2> /dev/null < /dev/null &
exec on node 0: sar -P ALL 1 > /tmp/results/0-cpu.txt 2> /dev/null < /dev/null &
exec on node 0: sar -n DEV 1 > /tmp/results/0-net.txt 2> /dev/null < /dev/null &
exec on node 0: sar -r 1 > /tmp/results/0-mem.txt 2> /dev/null < /dev/null &
exec on node 0: sar -d 1 > /tmp/results/0-disk.txt 2> /dev/null < /dev/null &
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.70
exec on node 1: sudo killall leveldb_main nova_shared_main nova_multi_thread_compaction nova_server_main java collectl sar
exec on node 1: sudo collectl -scx -i 1 -P > /tmp/results/1-coll.txt 2> /dev/null < /dev/null &
exec on node 1: sar -P ALL 1 > /tmp/results/1-cpu.txt 2> /dev/null < /dev/null &
exec on node 1: sar -n DEV 1 > /tmp/results/1-net.txt 2> /dev/null < /dev/null &
exec on node 1: sar -r 1 > /tmp/results/1-mem.txt 2> /dev/null < /dev/null &
exec on node 1: sar -d 1 > /tmp/results/1-disk.txt 2> /dev/null < /dev/null &
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.53
exec on node 2: sudo killall leveldb_main nova_shared_main nova_multi_thread_compaction nova_server_main java collectl sar
exec on node 2: sudo collectl -scx -i 1 -P > /tmp/results/2-coll.txt 2> /dev/null < /dev/null &
exec on node 2: sar -P ALL 1 > /tmp/results/2-cpu.txt 2> /dev/null < /dev/null &
exec on node 2: sar -n DEV 1 > /tmp/results/2-net.txt 2> /dev/null < /dev/null &
exec on node 2: sar -r 1 > /tmp/results/2-mem.txt 2> /dev/null < /dev/null &
exec on node 2: sar -d 1 > /tmp/results/2-disk.txt 2> /dev/null < /dev/null &
syning nova_server_main
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.74
exec on node 0: ps -ef | grep -v grep | grep -v ssh | grep -v bash | grep -c nova_server_main
exec on node 0: wait for it done
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.70
exec on node 1: ps -ef | grep -v grep | grep -v ssh | grep -v bash | grep -c nova_server_main
exec on node 1: wait for it done
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.53
exec on node 2: ps -ef | grep -v grep | grep -v ssh | grep -v bash | grep -c nova_server_main
exec on node 2: wait for it done
starting server
creating server on 0
stdbuf --output=0 --error=0 ./nova_server_main                 --ltc_migration_policy=immediate                 --enable_range_index=true                 --num_migration_threads=32                 --num_sstable_replicas=1                 --level=6                 --l0_start_compaction_mb=4096                 --subrange_no_flush_num_keys=100                 --enable_detailed_db_stats=false                 --major_compaction_type=sc                 --major_compaction_max_parallism=32                 --major_compaction_max_tables_in_a_set=20                 --enable_flush_multiple_memtables=true                 --recover_dbs=true                 --num_recovery_threads=32                 --sampling_ratio=1                 --zipfian_dist_ref_counts=/tmp/zipfian                 --client_access_pattern=uniform                  --memtable_type=static_partition                 --enable_subrange=true                 --num_log_replicas=1                 --log_record_mode=none                 --scatter_policy=power_of_two                 --number_of_ltcs=1                 --enable_lookup_index=true                 --l0_stop_write_mb=10240                 --num_memtable_partitions=64                 --num_memtables=256                 --num_rdma_bg_workers=16                 --db_path=/home/yuhang/NovaLSM/db_files/nova-db-10000000-1024                 --num_storage_workers=256                 --stoc_files_path=/home/yuhang/NovaLSM/db_files/stoc_files                 --max_stoc_file_size_mb=18432                 --sstable_size_mb=16                 --ltc_num_stocs_scatter_data_blocks=1                 --all_servers=192.168.98.74:10645,192.168.98.70:10645                 --server_id=0                 --mem_pool_size_gb=30                 --use_fixed_value_size=1024                 --ltc_config_path=/home/yuhang/NovaLSM/config/nova-tutorial-config                 --ltc_num_client_workers=512                 --num_rdma_fg_workers=16                 --num_compaction_workers=256                 --block_cache_mb=0                 --row_cache_mb=0                 --memtable_size_mb=16                 --cc_log_buf_size=1024                 --rdma_port=20247                 --rdma_max_msg_size=262144                 --rdma_max_num_sends=32                 --rdma_doorbell_batch_size=8                 --enable_rdma=True                 --enable_load_data=False                 --use_local_disk=false
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.74
exec on node 0: mkdir -p /home/yuhang/NovaLSM/db_files/stoc_files && mkdir -p /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024 &&  cd /home/yuhang/NovaLSM/nova && stdbuf --output=0 --error=0 ./nova_server_main                 --ltc_migration_policy=immediate                 --enable_range_index=true                 --num_migration_threads=32                 --num_sstable_replicas=1                 --level=6                 --l0_start_compaction_mb=4096                 --subrange_no_flush_num_keys=100                 --enable_detailed_db_stats=false                 --major_compaction_type=sc                 --major_compaction_max_parallism=32                 --major_compaction_max_tables_in_a_set=20                 --enable_flush_multiple_memtables=true                 --recover_dbs=true                 --num_recovery_threads=32                 --sampling_ratio=1                 --zipfian_dist_ref_counts=/tmp/zipfian                 --client_access_pattern=uniform                  --memtable_type=static_partition                 --enable_subrange=true                 --num_log_replicas=1                 --log_record_mode=none                 --scatter_policy=power_of_two                 --number_of_ltcs=1                 --enable_lookup_index=true                 --l0_stop_write_mb=10240                 --num_memtable_partitions=64                 --num_memtables=256                 --num_rdma_bg_workers=16                 --db_path=/home/yuhang/NovaLSM/db_files/nova-db-10000000-1024                 --num_storage_workers=256                 --stoc_files_path=/home/yuhang/NovaLSM/db_files/stoc_files                 --max_stoc_file_size_mb=18432                 --sstable_size_mb=16                 --ltc_num_stocs_scatter_data_blocks=1                 --all_servers=192.168.98.74:10645,192.168.98.70:10645                 --server_id=0                 --mem_pool_size_gb=30                 --use_fixed_value_size=1024                 --ltc_config_path=/home/yuhang/NovaLSM/config/nova-tutorial-config                 --ltc_num_client_workers=512                 --num_rdma_fg_workers=16                 --num_compaction_workers=256                 --block_cache_mb=0                 --row_cache_mb=0                 --memtable_size_mb=16                 --cc_log_buf_size=1024                 --rdma_port=20247                 --rdma_max_msg_size=262144                 --rdma_max_num_sends=32                 --rdma_doorbell_batch_size=8                 --enable_rdma=True                 --enable_load_data=False                 --use_local_disk=false >& /tmp/results/server-0-out < /dev/null &
creating server on 1
stdbuf --output=0 --error=0 ./nova_server_main                 --ltc_migration_policy=immediate                 --enable_range_index=true                 --num_migration_threads=32                 --num_sstable_replicas=1                 --level=6                 --l0_start_compaction_mb=4096                 --subrange_no_flush_num_keys=100                 --enable_detailed_db_stats=false                 --major_compaction_type=sc                 --major_compaction_max_parallism=32                 --major_compaction_max_tables_in_a_set=20                 --enable_flush_multiple_memtables=true                 --recover_dbs=true                 --num_recovery_threads=32                 --sampling_ratio=1                 --zipfian_dist_ref_counts=/tmp/zipfian                 --client_access_pattern=uniform                  --memtable_type=static_partition                 --enable_subrange=true                 --num_log_replicas=1                 --log_record_mode=none                 --scatter_policy=power_of_two                 --number_of_ltcs=1                 --enable_lookup_index=true                 --l0_stop_write_mb=10240                 --num_memtable_partitions=64                 --num_memtables=256                 --num_rdma_bg_workers=16                 --db_path=/home/yuhang/NovaLSM/db_files/nova-db-10000000-1024                 --num_storage_workers=256                 --stoc_files_path=/home/yuhang/NovaLSM/db_files/stoc_files                 --max_stoc_file_size_mb=18432                 --sstable_size_mb=16                 --ltc_num_stocs_scatter_data_blocks=1                 --all_servers=192.168.98.74:10645,192.168.98.70:10645                 --server_id=1                 --mem_pool_size_gb=30                 --use_fixed_value_size=1024                 --ltc_config_path=/home/yuhang/NovaLSM/config/nova-tutorial-config                 --ltc_num_client_workers=512                 --num_rdma_fg_workers=16                 --num_compaction_workers=256                 --block_cache_mb=0                 --row_cache_mb=0                 --memtable_size_mb=16                 --cc_log_buf_size=1024                 --rdma_port=20247                 --rdma_max_msg_size=262144                 --rdma_max_num_sends=32                 --rdma_doorbell_batch_size=8                 --enable_rdma=True                 --enable_load_data=False                 --use_local_disk=false
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.70
exec on node 1: mkdir -p /home/yuhang/NovaLSM/db_files/stoc_files && mkdir -p /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024 &&  cd /home/yuhang/NovaLSM/nova && stdbuf --output=0 --error=0 ./nova_server_main                 --ltc_migration_policy=immediate                 --enable_range_index=true                 --num_migration_threads=32                 --num_sstable_replicas=1                 --level=6                 --l0_start_compaction_mb=4096                 --subrange_no_flush_num_keys=100                 --enable_detailed_db_stats=false                 --major_compaction_type=sc                 --major_compaction_max_parallism=32                 --major_compaction_max_tables_in_a_set=20                 --enable_flush_multiple_memtables=true                 --recover_dbs=true                 --num_recovery_threads=32                 --sampling_ratio=1                 --zipfian_dist_ref_counts=/tmp/zipfian                 --client_access_pattern=uniform                  --memtable_type=static_partition                 --enable_subrange=true                 --num_log_replicas=1                 --log_record_mode=none                 --scatter_policy=power_of_two                 --number_of_ltcs=1                 --enable_lookup_index=true                 --l0_stop_write_mb=10240                 --num_memtable_partitions=64                 --num_memtables=256                 --num_rdma_bg_workers=16                 --db_path=/home/yuhang/NovaLSM/db_files/nova-db-10000000-1024                 --num_storage_workers=256                 --stoc_files_path=/home/yuhang/NovaLSM/db_files/stoc_files                 --max_stoc_file_size_mb=18432                 --sstable_size_mb=16                 --ltc_num_stocs_scatter_data_blocks=1                 --all_servers=192.168.98.74:10645,192.168.98.70:10645                 --server_id=1                 --mem_pool_size_gb=30                 --use_fixed_value_size=1024                 --ltc_config_path=/home/yuhang/NovaLSM/config/nova-tutorial-config                 --ltc_num_client_workers=512                 --num_rdma_fg_workers=16                 --num_compaction_workers=256                 --block_cache_mb=0                 --row_cache_mb=0                 --memtable_size_mb=16                 --cc_log_buf_size=1024                 --rdma_port=20247                 --rdma_max_msg_size=262144                 --rdma_max_num_sends=32                 --rdma_doorbell_batch_size=8                 --enable_rdma=True                 --enable_load_data=False                 --use_local_disk=false >& /tmp/results/server-1-out < /dev/null &
starting ycsb
creating client on 2-1
stdbuf --output=0 --error=0 bash {}/exp/run_ycsb.sh {} {} {} {} {} {} {} {} {} {} {} {} {} 0
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.53
exec on node 1: cd /home/yuhang/NovaLSM/YCSB-Nova && stdbuf --output=0 --error=0 bash {}/exp/run_ycsb.sh {} {} {} {} {} {} {} {} {} {} {} {} {} 0 >& /tmp/results/client-2-1-out < /dev/null &
change_cfg: false
waiting for experiments done
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.53
exec on node 2: ps -ef | grep -v "grep --color=auto ycsb" | grep -v ssh | grep -v bash | grep ycsb | grep -c java
wait for it done
getting db size
du -sm /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.74
exec on node 0: du -sm /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024 >& /tmp/results/server-0-db-disk-space < /dev/null
du -sm /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.70
exec on node 1: du -sm /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024 >& /tmp/results/server-1-db-disk-space < /dev/null
getting stoc file size
du -sm /home/yuhang/NovaLSM/db_files/stoc_files
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.74
exec on node 0: du -sm /home/yuhang/NovaLSM/db_files/stoc_files >& /tmp/results/server-0-rtable-disk-space
du -sm /home/yuhang/NovaLSM/db_files/stoc_files
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.70
exec on node 1: du -sm /home/yuhang/NovaLSM/db_files/stoc_files >& /tmp/results/server-1-rtable-disk-space
killing experiment processes
kill experiment processes on 0
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.74
exec on node 1: sudo killall leveldb_main nova_shared_main nova_multi_thread_compaction nova_server_main java collectl sar
kill experiment processes on 1
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.70
exec on node 1: sudo killall leveldb_main nova_shared_main nova_multi_thread_compaction nova_server_main java collectl sar
kill experiment processes on 2
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.53
exec on node 1: sudo killall leveldb_main nova_shared_main nova_multi_thread_compaction nova_server_main java collectl sar
saving to /home/yuhang/NovaLSM/nova-experiment-2023-10-16-12-21-20/nova-zf-0.99-nm-256-lr-1-cfg-false-d-uniform-w-workloadw-ltc-1-stoc-1-l0-10240-np-64-nr-1
getting logs
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.74
exec on node 0: mkdir -p /tmp/results/server-0-dblogs/ && cp -r /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024/*/LOG* /tmp/results/server-0-dblogs/
ssh prefix: ssh -oStrictHostKeyChecking=no -t yuhang@192.168.98.70
exec on node 1: mkdir -p /tmp/results/server-1-dblogs/ && cp -r /home/yuhang/NovaLSM/db_files/nova-db-10000000-1024/*/LOG* /tmp/results/server-1-dblogs/
transferring to main node
exec: scp -r yuhang@192.168.98.70:/tmp/results/* /home/yuhang/NovaLSM/nova-experiment-2023-10-16-12-21-20/nova-zf-0.99-nm-256-lr-1-cfg-false-d-uniform-w-workloadw-ltc-1-stoc-1-l0-10240-np-64-nr-1
exec: scp -r yuhang@192.168.98.70:/tmp/results/* /home/yuhang/NovaLSM/nova-experiment-2023-10-16-12-21-20/nova-zf-0.99-nm-256-lr-1-cfg-false-d-uniform-w-workloadw-ltc-1-stoc-1-l0-10240-np-64-nr-1
exec: scp -r yuhang@192.168.98.70:/tmp/results/* /home/yuhang/NovaLSM/nova-experiment-2023-10-16-12-21-20/nova-zf-0.99-nm-256-lr-1-cfg-false-d-uniform-w-workloadw-ltc-1-stoc-1-l0-10240-np-64-nr-1
processing results
exec: sudo python /home/yuhang/NovaLSM/scripts/exp/parse_ycsb_nova_leveldb.py 3 /home/yuhang/NovaLSM/nova-experiment-2023-10-16-12-21-20 > /home/yuhang/NovaLSM/nova-experiment-2023-10-16-12-21-20/stats_tutorial_out
